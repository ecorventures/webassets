/**
  * v1.0.0 generated on: Sun Jan 10 2016 10:39:20 GMT-0600 (CST)
  * Copyright (c) 2014-2016, Ecor Ventures LLC. All Rights Reserved.
  */
"use strict";window.ECOR=window.ECOR||{},NGN||console.error("ECOR.ApiClient requires NGN"),ECOR.ApiClient=function(e){var t=window.NGN.HTTP||null;if(!t)throw new Error("The ApiClient requires the NGN Chassis HTTP module.");e=e||{};var n=null,s=window.NGN.BUS||null,i=function(){s&&s.emit.apply(s,arguments)};Object.defineProperties(this,{host:NGN.define(!0,!0,!1,e.host||window.location),root:NGN.define(!0,!0,!1,e.root||"/"),headers:NGN.define(!0,!1,!1,e.headers||{}),loginPath:NGN.define(!1,!1,!1,e.loginPath||"oauth/login"),accessToken:NGN._get(function(){return n||null}),base:NGN._get(function(){return this.host+this.root}),authenticate:NGN.define(!0,!1,!1,function(e,s,o){if(null===n){var r=this;t.post({url:this.base+this.loginPath,username:e,password:s,headers:this.headers},function(e){if(200===e.status){var t="string"!=typeof e.response?e.response:JSON.parse(e.responseText);n=t.token.access_token,i("api.authentication.success"),o&&o(!0),setTimeout(function(){r.refreshToken(o)},1e3*(t.token.expires_in-1.5))}else{var s=e.responseText||e.statusText;i("api.authentication.failure",s),o&&o(!1,s)}})}}),refreshToken:NGN.define(!1,!1,!1,function(e){var s=this;t.post({url:this.base+"oauth/token",accessToken:n,headers:this.headers},function(t){if(200===t.status){var o="string"!=typeof t.response?t.response:JSON.parse(t.responseText);n=o.token.access_token,i("api.authentication.refresh"),e&&e(!0),setTimeout(function(){s.refreshToken()},1e3*(o.token.expires_in-1.5))}else{var r="Authentication expired. "+(t.responseText||t.statusText);i("api.authentication.failure",r),e&&e(!1,r)}})}),secure:NGN.define(!1,!1,!1,function(e){null===n&&console.warn("Attempting to use the API without authentication."),e&&e()})})};